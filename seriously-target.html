<link rel="import" href="./seriously-node.html">
	
<polymer-element name="seriously-target" extends="seriously-node">
	
	<template>
		<canvas id="canvas" width="{{width}}" height="{{height}}"></canvas>
	</template>

	<script>

		Polymer('seriously-target', {
	
			publish: {
				width: 300,
				height: 150,
				source: null,
				type: 'target', // doesn't do anything...
			},

			domReady: function(){
				this.getNode();
			},

			getNode: function(){
				if(this.node == undefined){
					this._seriously = this.parentNode.seriously;
					this.node = this._seriously.target(this.$.canvas);
				}
				return this.node;
			},

			// sourceChanged: function(){
				// console.log('seriously-target.sourceChanged', this.source, this.source.getNode());
				// this.getNode().source = this.source.getNode();

					// var observer = new ObjectObserver(this.node);
					// observer.open(function(added, removed, changed, getOldValueFn) {
					// 	Object.keys(changed).forEach(function(property) {
					// 		console.log(property, changed[property]);
					// 	});
					// });
			// },

			//TODO: listen for changes to this.source.node, reassign this.node.source
			//TODO: do the same in seriously-effect

			widthChanged: function(){
				this._updateSize();
			},
			heightChanged: function(){
				this._updateSize();
			},
			_updateSize: function(){
				if(!this.node) return;
				this.node.width = this.width;
				this.node.height = this.height;
			},

		});

	</script>

</polymer-element>